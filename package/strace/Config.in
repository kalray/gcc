config BR2_PACKAGE_STRACE
	bool "strace"
	# needs at least kernel headers 4.0 on nios2
	depends on BR2_TOOLCHAIN_HEADERS_AT_LEAST_4_0 || !BR2_nios2
	# needs at least kernel headers 5.0 on xtensa
	depends on BR2_TOOLCHAIN_HEADERS_AT_LEAST_5_0 || !BR2_xtensa
	depends on !BR2_nds32 && !BR2_RISCV_32
	help
	  A useful diagnostic, instructional, and debugging tool.
	  Allows you to track what system calls a program makes
	  while it is running.

	  If you want 'strace -k' to work, make sure to enable the
	  'libunwind' package.

	  https://strace.io

comment "strace needs a toolchain w/ headers >= 4.0 on nios2"
	depends on BR2_nios2
	depends on !BR2_TOOLCHAIN_HEADERS_AT_LEAST_4_0

comment "strace needs a toolchain w/ headers >= 5.0 on xtensa"
	depends on BR2_xtensa
	depends on !BR2_TOOLCHAIN_HEADERS_AT_LEAST_5_0

choice
	prompt "Strace Version"
	default BR2_STRACE_VERSION_KVX if BR2_kvx
	help
	  Select the version of strace you wish to use.

config BR2_STRACE_VERSION_KVX
	bool "Strace KVX"
	depends on BR2_kvx

config BR2_STRACE_CUSTOM_VERSION
	bool "Custom version"
	help
	  This option allows to use a specific official versions

endchoice

config BR2_STRACE_CUSTOM_VERSION_VALUE
	string "Strace version"
	depends on BR2_STRACE_CUSTOM_VERSION

config BR2_STRACE_VERSION
	string
	default BR2_STRACE_CUSTOM_VERSION_VALUE if BR2_STRACE_CUSTOM_VERSION
	default "19f3bb2e38be375d5febfbf6e517623a3da5d703" if BR2_STRACE_VERSION_KVX
	default "5.12"
