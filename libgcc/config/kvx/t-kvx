HOST_LIBGCC2_CFLAGS += -ffunction-sections -fdata-sections

softfp-func-exclude := divsf3 divdf3
softfp_file_list := \
  $(filter-out $(addsuffix .c, \
                           $(addprefix $(srcdir)/soft-fp/, \
                                       $(softfp-func-exclude))), \
               $(softfp_file_list))

kvx-libgcc-funcs := \
  $(softfp-func-exclude) \
  divmoddi divmodsi \
  divmodvxdi divmodvxsi divmodvxhi divmodvxqi \
  divv2df3 divv2sf3 divv4df3 divv4sf3 divv8sf3

kvx-libgcc-c := $(addsuffix .c,$(kvx-libgcc-funcs))
kvx-libgcc-o := $(addsuffix .o,$(kvx-libgcc-funcs))
kvx-libgcc-files := $(addprefix $(srcdir)/config/kvx/, $(kvx-libgcc-c))

$(kvx-libgcc-o): CFLAGS += -Werror

LIB2ADD += $(kvx-libgcc-files)
LIB2FUNCS_EXCLUDE += $(addprefix _,$(softfp-func-exclude))

SHLIB_MAPFILES += $(srcdir)/config/kvx/libgcc-vector.ver

crtcxa.o: $(srcdir)/config/kvx/crtcxa.c
	$(crt_compile) -c $<

crtcxa_s.o: $(srcdir)/config/kvx/crtcxa.c
	$(crt_compile) -DSHARED -c $<
